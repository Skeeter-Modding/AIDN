# =============================================================================
# AIDN - Fail2ban Filter for Arma Reforger Server
# =============================================================================
# Copy to: /etc/fail2ban/filter.d/arma-reforger.conf
#
# This filter detects suspicious activity patterns in Arma Reforger logs
# Adjust regex patterns based on your actual log format
# =============================================================================

[Definition]

# Common prefixes for Arma Reforger logs
_daemon = arma-?reforger|ArmaReforgerServer

# Failed connection attempts
failregex = ^.*Connection failed from <HOST>.*$
            ^.*Rejected connection from <HOST>.*$
            ^.*Invalid packet from <HOST>.*$
            ^.*Kicked player.*IP:?\s*<HOST>.*$
            ^.*Ban.*<HOST>.*$
            ^.*Player kicked.*<HOST>.*$
            ^.*Authentication failed.*<HOST>.*$
            ^.*Malformed packet from <HOST>.*$
            ^.*Rate limit exceeded.*<HOST>.*$
            ^.*Suspicious activity from <HOST>.*$
            ^.*Flood detected from <HOST>.*$

# Ignore legitimate connections
ignoreregex = ^.*Connected successfully.*$
              ^.*Player joined.*$
              ^.*Authenticated player.*$
