# ============================================================================
# AIDN - AI Defense Network Configuration
# ============================================================================
# This is the main configuration file for AIDN DDoS protection system.
# Modify these settings to tune protection for your specific environment.

[general]
# Enable AIDN protection (1 = enabled, 0 = disabled)
enabled = 1

# Learning mode: collect data without blocking (1 = learning, 0 = protection)
# Start in learning mode for the first hour to establish baseline
learning_mode = 0

# Log level: debug, info, warning, error
log_level = info

# Data directory for ML models and profiles
data_dir = /var/lib/aidn

# Log directory
log_dir = /var/log/aidn

# ============================================================================
# NETWORK CONFIGURATION
# ============================================================================
[network]
# Primary network interface (auto-detected if empty)
interface =

# Game server ports (comma-separated) - gets higher rate limits
game_ports = 2001,2002,17777

# Query port - stricter rate limiting
query_port = 17777

# RCON port
rcon_port = 19999

# SSH port
ssh_port = 10022

# ============================================================================
# XDP/FIREWALL CONFIGURATION
# ============================================================================
[xdp]
# XDP mode: native, generic, or auto
# native = fastest (requires driver support)
# generic = slower but compatible with all drivers
# auto = try native, fallback to generic
mode = auto

# Maximum tracked IPs (memory usage scales with this)
max_tracked_ips = 1000000

# Maximum whitelist entries
max_whitelist = 100000

# Maximum blacklist entries
max_blacklist = 500000

# ============================================================================
# RATE LIMITING
# ============================================================================
[rate_limits]
# Global packets per second limit per IP
# Set high enough to not affect legitimate players
global_pps = 10000

# SYN packets per second per IP (protect against SYN floods)
syn_pps = 100

# UDP packets per second per IP
# Higher for game servers that use UDP
udp_pps = 5000

# ICMP packets per second per IP
icmp_pps = 10

# Game traffic multiplier (game ports get this multiplier on limits)
# E.g., 5.0 means game traffic can be 5x the normal limit
game_traffic_multiplier = 5.0

# ============================================================================
# AI/ML CONFIGURATION
# ============================================================================
[ai]
# Minimum training samples before enabling ML detection
min_training_samples = 1000

# Anomaly detection contamination rate (lower = fewer false positives)
# 0.001 = expect 0.1% of traffic to be anomalous
contamination = 0.001

# Minimum confidence to take rate limiting action
confidence_rate_limit = 0.70

# Minimum confidence to block (very high to prevent false positives)
confidence_block = 0.90

# Trust score threshold for auto-whitelisting
# Players with trust >= this get auto-whitelisted
auto_whitelist_threshold = 85

# Trust boost for legitimate game sessions
trust_boost_session = 5.0

# Trust penalty multiplier for anomalous behavior
trust_penalty_multiplier = 10.0

# ============================================================================
# PLAYER PROTECTION (Anti False-Positive)
# ============================================================================
[player_protection]
# Enable player behavior learning
learn_players = 1

# Minimum sessions before trusting a player
min_sessions_for_trust = 3

# Minimum age (seconds) before auto-whitelist
min_age_for_whitelist = 3600

# Grace period for new IPs (seconds) - be lenient with new connections
new_ip_grace_period = 300

# Maximum false positive rate target (0.001 = 0.1%)
max_false_positive_rate = 0.001

# ============================================================================
# BLACKLIST CONFIGURATION
# ============================================================================
[blacklist]
# Default ban duration in seconds
default_ban_duration = 3600

# Repeat offender multiplier (each repeat offense multiplies ban time)
repeat_offender_multiplier = 2.0

# Maximum ban duration in seconds (7 days)
max_ban_duration = 604800

# Auto-blacklist after this many violations in rate limit window
violation_threshold = 10

# ============================================================================
# DISCORD NOTIFICATIONS
# ============================================================================
[discord]
# Enable Discord webhook notifications
enabled = 0

# Discord webhook URL (create one in Discord server settings -> Integrations)
# Example: https://discord.com/api/webhooks/1234567890/abcdefghijk
webhook_url =

# Server name to display in notifications
server_name = My Game Server

# Notification settings - what to notify about (1 = enabled, 0 = disabled)
notify_attacks = 1
notify_blocks = 1
notify_rate_limits = 0
notify_whitelists = 0
notify_system_status = 1

# Minimum severity to notify: low, medium, high, critical
min_severity = medium

# Rate limiting for Discord notifications
max_notifications_per_minute = 30
max_notifications_per_hour = 500

# Send periodic status summaries (0 = disabled, or interval in minutes)
status_summary_interval = 60

# ============================================================================
# ALERTING (Legacy - use Discord section above for webhooks)
# ============================================================================
[alerts]
# Enable alerting
enabled = 1

# Alert methods: log, discord, email (comma-separated)
methods = log,discord

# Email address for alerts (optional)
email_to =

# Minimum severity to alert: info, warning, critical
min_severity = warning

# ============================================================================
# MONITORING
# ============================================================================
[monitoring]
# Enable Prometheus metrics export
prometheus_enabled = 0

# Prometheus metrics port
prometheus_port = 9100

# Enable terminal dashboard
dashboard_enabled = 1

# Stats update interval in seconds
update_interval = 1

# ============================================================================
# ADVANCED TUNING
# ============================================================================
[advanced]
# Connection tracking timeout for established connections (seconds)
conntrack_established_timeout = 432000

# Connection tracking timeout for new connections (seconds)
conntrack_new_timeout = 30

# Maximum connections to track
conntrack_max = 1048576

# Ring buffer size for events (bytes, must be power of 2)
event_buffer_size = 16777216

# Worker threads for AI processing
ai_workers = 4
